# 認証機能付きWebアプリケーション

## 1. 概要

本プロジェクトは、Next.jsを用いて構築した認証・認可機能を持つWebアプリケーションである。セキュリティを考慮したユーザー管理機能の実装を行った。
また、認証方式にはセッションベース認証を採用した。

## 2. 実装機能一覧

-   **標準機能**
    -   ユーザー登録（サインアップ）
    -   ログイン・ログアウト
-   **追加実装機能**
    -   連続ログイン失敗によるアカウントロック機能
    -   パスワードの変更機能

## 3. 実装機能詳細

### 3.1. 連続ログイン失敗によるアカウントロック機能

#### 目的

ブルートフォース攻撃（総当たり攻撃）やパスワードリスト攻撃に対し、アカウントの乗っ取り耐性を向上させることを目的とする。一定回数以上連続で認証に失敗したアカウントを一時的にロックし、攻撃を無効化する。

#### 実装内容

-   **データベーススキーマの変更**
    Prismaの`User`モデルに、ログイン失敗回数を記録する`failedLoginAttempts`（INTEGER型）と、アカウントのロック状態を示す`isLocked`（BOOLEAN型）の2つのフィールドを追加した。

-   **認証ロジックの変更**
    ユーザーのログイン処理において、以下のロジックを実装した。
    1.  認証試行時、対象アカウントの`isLocked`が`true`である場合、認証処理を中断し、アカウントがロックされに関するエラーを返却する。
    2.  認証に失敗した場合、`failedLoginAttempts`をインクリメントする。
    3.  `failedLoginAttempts`が規定の閾値(5回)に達した場合、`isLocked`を`true`に更新し、アカウントをロック状態へ遷移させる。
    4.  認証に成功した場合、`failedLoginAttempts`を`0`にリセットする。

-   **UIへのフィードバック**
    アカウントがロック状態のユーザーがログインを試みた際、フロントエンドで「アカウントはロックされています。約〇分後にもう一度お試しください。」といった具体的なエラーメッセージを表示するよう実装した。

### 3.2. 

## 4. 使用技術

-   フレームワーク: Next.js
-   言語: TypeScript
-   ORM: Prisma
-   データベース: PostgreSQL
-   スタイリング: Tailwind CSS
- フォーム管理: React Hook Form
-   セキュリティ: bcrypt (パスワードハッシュ化)
-   バリデーション: Zod